[gd_scene load_steps=34 format=3 uid="uid://mskhe0dyhjbs"]

[ext_resource type="Script" path="res://script/management/level_class.gd" id="1_jntc8"]
[ext_resource type="Resource" uid="uid://c4x5yp1d8vfh" path="res://resource/loading_preset/unmp_entrance.tres" id="2_iy70q"]
[ext_resource type="Texture2D" uid="uid://3rmvpbt3qnl8" path="res://vlcsnap-2025-06-21-11h38m33s414.png" id="3_c8iwm"]
[ext_resource type="Script" path="res://script/resource/environment_resource.gd" id="3_q4vub"]
[ext_resource type="Texture2D" uid="uid://1wcxg6xdjwwb" path="res://vlcsnap-2025-06-21-12h46m23s000.png" id="4_tsotb"]
[ext_resource type="ArrayMesh" uid="uid://b14bmfs2xvrf1" path="res://asset/3d/room/child_library/bedroom_color.obj" id="4_x18x4"]
[ext_resource type="Script" path="res://script/management/nifty_class.gd" id="5_0wh13"]
[ext_resource type="ArrayMesh" uid="uid://dlebf07ebpebh" path="res://asset/3d/room/child_library/bedroom_concrete.obj" id="6_4tgri"]
[ext_resource type="ArrayMesh" uid="uid://bife0p1g4ed8u" path="res://asset/3d/room/child_library/furniture.obj" id="7_7uc02"]
[ext_resource type="Shader" path="res://shader/spatial/psx_lit_alpha.gdshader" id="7_455tg"]
[ext_resource type="Shader" path="res://shader/spatial/psx_lit.gdshader" id="8_55nmx"]
[ext_resource type="Texture2D" uid="uid://byiv8xpduwfj7" path="res://asset/3d/room/child_library/texture_placeholder.png" id="8_bop7h"]
[ext_resource type="PackedScene" uid="uid://cbthuj1ruvyii" path="res://scene/object/interactive/overworld_face.tscn" id="8_wyb1l"]
[ext_resource type="Shader" path="res://shader/spatial/psx_lit_alpha_blend.gdshader" id="10_f5yhi"]
[ext_resource type="ArrayMesh" uid="uid://dh2aw3bxkf0ty" path="res://asset/3d/room/child_library/lamp.obj" id="10_rht1x"]
[ext_resource type="Shader" path="res://shader/spatial/psx_unlit.gdshader" id="11_kaert"]
[ext_resource type="PackedScene" uid="uid://dlx0cy1oqhle4" path="res://scene/object/environment/child_bedroom_node.tscn" id="14_l3aij"]
[ext_resource type="Texture2D" uid="uid://dvfa36tvcxi7m" path="res://asset/3d/room/child_library/bedroom_tiles.png" id="17_cvgx6"]
[ext_resource type="Texture2D" uid="uid://bpwvhj31j1rsa" path="res://asset/3d/room/child_library/bedroom_walls.png" id="18_4f7x6"]
[ext_resource type="Resource" uid="uid://5745c1x12tb2" path="res://resource/bedroom/care.tres" id="19_h3gcm"]
[ext_resource type="Script" path="res://script/object/trigger/dialogue_trigger.gd" id="19_lqwop"]
[ext_resource type="Script" path="res://script/object/interactive/level/spawn.gd" id="22_rhaia"]
[ext_resource type="PackedScene" uid="uid://dn6hdyapwjmyp" path="res://scene/object/interactive/level/warp.tscn" id="23_nc6i6"]
[ext_resource type="Resource" uid="uid://be8ufsmpisef4" path="res://resource/loading_preset/nmp_noload.tres" id="24_3fpas"]

[sub_resource type="Resource" id="Resource_qdytq"]
script = ExtResource("3_q4vub")
sky_color = Color(0, 0, 0, 1)
scroll_speed = 0.2
offset_y = 0.25
ambient_color = Color(0.7, 0.7, 0.7, 1)
environment_darkness = 0.7
enable_fog = true
fog_color = Color(0, 0, 0, 1)
fog_radius = 5.5

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ediux"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("7_455tg")
shader_parameter/use_fog = true
shader_parameter/modulate_color = Color(1, 1, 1, 1)
shader_parameter/alpha_color = Color(1, 0, 1, 1)
shader_parameter/albedoTex = ExtResource("8_bop7h")
shader_parameter/uv_scale = Vector2(1, 1)
shader_parameter/uv_offset = Vector2(0, 0)
shader_parameter/uv_pan_velocity = Vector2(0, 0)
shader_parameter/tile_mode = false
shader_parameter/tile = Vector2i(0, 0)
shader_parameter/per_quad_depth = false
shader_parameter/adjustable_depth = false
shader_parameter/depth_offset = null

[sub_resource type="QuadMesh" id="QuadMesh_i3ahc"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_lrs17"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("10_f5yhi")
shader_parameter/use_fog = true
shader_parameter/modulate_color = Color(1, 1, 1, 1)
shader_parameter/alpha_color = Color(1, 0, 1, 1)
shader_parameter/albedoTex = ExtResource("8_bop7h")
shader_parameter/uv_scale = Vector2(0.25, 0.25)
shader_parameter/uv_offset = Vector2(0.5, 0.5)
shader_parameter/uv_pan_velocity = Vector2(0, 0)
shader_parameter/tile_mode = false
shader_parameter/tile = Vector2i(0, 0)
shader_parameter/per_quad_depth = false
shader_parameter/adjustable_depth = false
shader_parameter/depth_offset = Vector3(0, 0, 0)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_pduwi"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("10_f5yhi")
shader_parameter/use_fog = true
shader_parameter/modulate_color = Color(1, 1, 1, 1)
shader_parameter/alpha_color = Color(1, 0, 1, 1)
shader_parameter/albedoTex = ExtResource("8_bop7h")
shader_parameter/uv_scale = Vector2(1, 1)
shader_parameter/uv_offset = Vector2(0, 0)
shader_parameter/uv_pan_velocity = Vector2(0, 0)
shader_parameter/tile_mode = false
shader_parameter/tile = Vector2i(0, 0)
shader_parameter/per_quad_depth = false
shader_parameter/adjustable_depth = false
shader_parameter/depth_offset = Vector3(0, 0, 0)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_1ycs2"]
render_priority = 0
shader = ExtResource("8_55nmx")
shader_parameter/use_fog = true
shader_parameter/modulate_color = Color(1, 1, 1, 1)
shader_parameter/uv_scale = Vector2(1, 1)
shader_parameter/uv_offset = Vector2(0, 0)
shader_parameter/uv_pan_velocity = Vector2(0, 0)
shader_parameter/tile_mode = false
shader_parameter/tile = Vector2i(0, 0)
shader_parameter/per_quad_depth = false
shader_parameter/adjustable_depth = false
shader_parameter/depth_offset = null

[sub_resource type="ShaderMaterial" id="ShaderMaterial_oaduq"]
render_priority = 0
shader = ExtResource("11_kaert")
shader_parameter/use_fog = true
shader_parameter/modulate_color = Color(1, 1, 1, 1)
shader_parameter/uv_scale = Vector2(1, 1)
shader_parameter/uv_offset = Vector2(0, 0)
shader_parameter/uv_pan_velocity = Vector2(0, 0)
shader_parameter/tile_mode = false
shader_parameter/tile = Vector2i(0, 0)
shader_parameter/per_quad_depth = false
shader_parameter/adjustable_depth = false
shader_parameter/depth_offset = null

[sub_resource type="WorldBoundaryShape3D" id="WorldBoundaryShape3D_5wq3g"]
plane = Plane(0, 0, 1, 0)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_ix6x0"]
data = PackedVector3Array(-1.25, -0.5, -6, -1.25, -0.5, -2.5, -1.25, 0.5, -6, -1.25, 0.5, -6, -1.25, -0.5, -2.5, -1.25, 0.5, -2.5, 4.5, -0.5, 1, 4.5, -0.5, -1.5, 4.5, 0.5, 1, 4.5, 0.5, 1, 4.5, -0.5, -1.5, 4.5, 0.5, -1.5, -3.5, -0.5, 1, 2.375, -0.5, 1, -3.5, 0.5, 1, -3.5, 0.5, 1, 2.375, -0.5, 1, 2.375, 0.5, 1, 3.625, -0.5, 1, 4.5, -0.5, 1, 3.625, 0.5, 1, 3.625, 0.5, 1, 4.5, -0.5, 1, 4.5, 0.5, 1, 2.375, 0.5, 1, 2.375, -0.5, 1, 2.375, 0.5, 4.5, 2.375, 0.5, 4.5, 2.375, -0.5, 1, 2.375, -0.5, 4.5, 3.625, -0.5, 1, 3.625, 0.5, 1, 3.625, -0.5, 4.5, 3.625, -0.5, 4.5, 3.625, 0.5, 1, 3.625, 0.5, 4.5, 1.5, -0.5, -14.5, 1.5, -0.5, -7.5, 1.5, 0.5, -14.5, 1.5, 0.5, -14.5, 1.5, -0.5, -7.5, 1.5, 0.5, -7.5, -1.25, -0.5, -2.5, -3.5, -0.5, -2.5, -1.25, 0.5, -2.5, -1.25, 0.5, -2.5, -3.5, -0.5, -2.5, -3.5, 0.5, -2.5, -3.5, -0.5, -2.5, -3.5, -0.5, 1, -3.5, 0.5, -2.5, -3.5, 0.5, -2.5, -3.5, -0.5, 1, -3.5, 0.5, 1, 1, -0.5, -1.5, 1, -0.5, -3.5, 1, 0.5, -1.5, 1, 0.5, -1.5, 1, -0.5, -3.5, 1, 0.5, -3.5, 4.5, -0.5, -1.5, 1, -0.5, -1.5, 4.5, 0.5, -1.5, 4.5, 0.5, -1.5, 1, -0.5, -1.5, 1, 0.5, -1.5, 1, -0.5, -3.5, 4.5, -0.5, -3.5, 1, 0.5, -3.5, 1, 0.5, -3.5, 4.5, -0.5, -3.5, 4.5, 0.5, -3.5, 4.5, -0.5, -3.5, 4.5, -0.5, -14.5, 4.5, 0.5, -3.5, 4.5, 0.5, -3.5, 4.5, -0.5, -14.5, 4.5, 0.5, -14.5, -3.5, -0.5, -7.5, -3.5, -0.5, -6, -3.5, 0.5, -7.5, -3.5, 0.5, -7.5, -3.5, -0.5, -6, -3.5, 0.5, -6, -1.25, -0.5, -6, -1.25, 0.5, -6, -3.5, -0.5, -6, -3.5, -0.5, -6, -1.25, 0.5, -6, -3.5, 0.5, -6, -3.5, 0.5, -7.5, 1.5, 0.5, -7.5, -3.5, -0.5, -7.5, -3.5, -0.5, -7.5, 1.5, 0.5, -7.5, 1.5, -0.5, -7.5)

[node name="child-library-bedroom" type="Node3D" node_paths=PackedStringArray("fog_focus")]
script = ExtResource("1_jntc8")
room_name = "child-library-bedroom"
loading_preset = ExtResource("2_iy70q")
footstep_sound = 3
spawn_camera_root = false
environment_settings = SubResource("Resource_qdytq")
fog_focus_on_player = false
fog_focus = NodePath("FogFocus")

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.951057, 0.309017, 0, -0.309017, 0.951057, 0.5, 3.9, 7.5)
fov = 35.0

[node name="Sprite3D" type="Sprite3D" parent="Camera3D"]
transform = Transform3D(1, 0, 0, 0, 1, -5.96046e-08, 0, 5.96046e-08, 1, 0, 7.15256e-07, -11.5)
visible = false
modulate = Color(1, 1, 1, 0.968627)
no_depth_test = true
texture = ExtResource("3_c8iwm")

[node name="Camera3D2" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.906308, 0.422618, 0, -0.422618, 0.906308, 2.45, 2.75, 1.5)
fov = 35.0

[node name="Sprite3D" type="Sprite3D" parent="Camera3D2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -11.5)
visible = false
modulate = Color(1, 1, 1, 0.968627)
no_depth_test = true
texture = ExtResource("4_tsotb")

[node name="BedroomTop" type="MeshInstance3D" parent="."]
mesh = ExtResource("4_x18x4")
surface_material_override/0 = SubResource("ShaderMaterial_ediux")
script = ExtResource("5_0wh13")

[node name="BedroomNote" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, -7.5)
mesh = SubResource("QuadMesh_i3ahc")
surface_material_override/0 = SubResource("ShaderMaterial_lrs17")
script = ExtResource("5_0wh13")

[node name="BedroomConcrete" type="MeshInstance3D" parent="."]
mesh = ExtResource("6_4tgri")
surface_material_override/0 = SubResource("ShaderMaterial_pduwi")
script = ExtResource("5_0wh13")

[node name="Furniture" type="MeshInstance3D" parent="."]
mesh = ExtResource("7_7uc02")
surface_material_override/0 = SubResource("ShaderMaterial_1ycs2")

[node name="Lamp" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.45, 1.015, -2.35)
mesh = ExtResource("10_rht1x")
surface_material_override/0 = SubResource("ShaderMaterial_oaduq")

[node name="OverworldChildFace" parent="." instance=ExtResource("8_wyb1l")]
transform = Transform3D(-1.09278e-07, 0, -2.5, 0, 2.5, 0, 2.5, 0, -1.09278e-07, 3.85, 2.225, -3.512)
always_visible = true
load_from_file = true
update_on_signal = false

[node name="FogFocus" type="Marker3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.5, 0.5, -3)

[node name="DialogueTrigger" type="Marker3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -7)
script = ExtResource("19_lqwop")
min_distance = 0.5

[node name="ChildBedroomNode" parent="." node_paths=PackedStringArray("overworld_face", "note_sprite", "note_trigger", "textured_meshes", "colored_meshes") instance=ExtResource("14_l3aij")]
default_colors = Array[Color]([Color(1, 1, 0.25098, 1), Color(1, 0.25, 0.625, 1), Color(0.1875, 0.75, 0.1875, 1), Color(0.1875, 0.75, 0.75, 1), Color(1, 0.5, 0.5, 1), Color(0.498039, 0.188235, 0.74902, 1), Color(0.411765, 0, 0.74902, 1)])
allowed_random_floor_tiles = Array[int]([0, 1, 3, 4, 7, 8])
allowed_random_wall_tiles = Array[int]([0, 1, 3, 4, 7, 8])
predefined_bedrooms = Array[Resource("res://script/resource/predefined_bedroom.gd")]([ExtResource("19_h3gcm")])
floor_texture = ExtResource("17_cvgx6")
floor_texture_frames = Vector2i(4, 4)
wall_texture = ExtResource("18_4f7x6")
wall_texture_frames = Vector2i(4, 4)
overworld_face = NodePath("../OverworldChildFace")
note_sprite = NodePath("../BedroomNote")
note_trigger = NodePath("../DialogueTrigger")
textured_meshes = [NodePath("../BedroomTop"), NodePath("../BedroomConcrete")]
colored_meshes = [NodePath("../BedroomTop"), NodePath("../Furniture"), NodePath("../Lamp")]

[node name="WallBody" type="StaticBody3D" parent="."]

[node name="WallShape" type="CollisionShape3D" parent="WallBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -7.5)
shape = SubResource("WorldBoundaryShape3D_5wq3g")

[node name="LevelCollision" type="StaticBody3D" parent="."]

[node name="LevelShape" type="CollisionShape3D" parent="LevelCollision"]
shape = SubResource("ConcavePolygonShape3D_ix6x0")

[node name="SpawnClass" type="Marker3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3, 0, 2)
script = ExtResource("22_rhaia")
scene_path = "res://scene/room/unmp/child_library.tscn"
player_direction = 3

[node name="Warp" parent="." instance=ExtResource("23_nc6i6")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3, 0, 2.6)
scene = "res://scene/room/unmp/child_library.tscn"
loading_preset = ExtResource("24_3fpas")
